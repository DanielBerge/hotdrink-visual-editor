(this["webpackJsonphd-visual2"]=this["webpackJsonphd-visual2"]||[]).push([[0],{126:function(e,t,n){"use strict";n.r(t);var o,r,i,c,a=n(1),s=n.n(a),d=n(21),u=n.n(d),l=(n(88),n(8)),b=n(5),h=n(7);!function(e){e.Input="input",e.Button="button",e.Text="text",e.Checkbox="checkbox"}(o||(o={})),function(e){e.Text="text",e.Number="number",e.Date="date"}(r||(r={})),function(e){e.CODE="CODE",e.VISUAL="VISUAL"}(i||(i={})),function(e){e.Value="value",e.Disabled="disabled",e.InnerText="innertext",e.Checked="checked"}(c||(c={}));var m=n(10),p=n(0),v=s.a.createContext({}),j=s.a.createContext({}),f=function(e){var t=Object(a.useState)([]),n=Object(b.a)(t,2),o=n[0],r=n[1],i=Object(a.useState)(void 0),c=Object(b.a)(i,2),s=c[0],d=c[1];return Object(p.jsx)(v.Provider,{value:{elements:o,addElement:function(e){r([].concat(Object(m.a)(o),[e]))},updateElement:function(e,t){var n=o.findIndex((function(t){return t.id===e.id}));return-1!==n?(o[n]=t,r(o)):console.warn("Could not find element to update"),t},getElementById:function(e){return o.find((function(t){return t.id===e}))},deleteElement:function(e){r(o.filter((function(t){return e!==t.id})))}},children:Object(p.jsx)(j.Provider,{value:{current:s,setCurrent:d},children:e.children})})};function x(){var e=Object(a.useContext)(v),t=e.elements,n=e.addElement,o=e.updateElement,r=e.getElementById,i=e.deleteElement,c=Object(a.useContext)(j);return{elements:t,addElement:n,updateElement:o,getElementById:r,current:c.current,setCurrent:c.setCurrent,deleteElement:i}}var O=s.a.createContext({}),g=function(e){var t=Object(a.useState)(""),n=Object(b.a)(t,2),o=n[0],r=n[1],i=Object(a.useState)(""),c=Object(b.a)(i,2),s=c[0],d=c[1];return Object(p.jsx)(O.Provider,{value:{message:o,setMessage:r,error:s,setError:d,clearMessages:function(){r(""),d("")}},children:e.children})};function _(){var e=Object(a.useContext)(O);return{message:e.message,setMessage:e.setMessage,error:e.error,setError:e.setError,clearMessages:e.clearMessages}}var C=0;var y=s.a.createContext({}),w=s.a.createContext(!1),k=s.a.createContext({}),M=function(e){var t=_(),n=Object(a.useState)([]),o=Object(b.a)(n,2),r=o[0],c=o[1],s=Object(a.useState)(!1),d=Object(b.a)(s,2),u=d[0],h=d[1],v=Object(a.useState)(!1),j=Object(b.a)(v,2),f=j[0],x=j[1],O=Object(a.useState)(void 0),g=Object(b.a)(O,2),M=g[0],I=g[1],E=Object(a.useState)(void 0),T=Object(b.a)(E,2),S=T[0],N=T[1],L=Object(a.useState)([]),D=Object(b.a)(L,2),B=D[0],P=D[1];function A(e){e?t.setMessage("Click on the elements you want to add a constraint to."):t.clearMessages(),h(e)}function W(e){e?t.setMessage("Click on the elements you want to add a method output connection to."):t.clearMessages(),x(e)}function F(e){return e.reduce((function(e,t){return t.id.length>e?t.id.length:e}),0)}function R(e,t){var n=r.findIndex((function(t){return t.fromIds===e.fromIds&&t.methods===e.methods}));return-1!==n?(r[n]=t,c(r)):console.warn("Could not find constraint to update"),t}return Object(p.jsx)(y.Provider,{value:{constraints:r,setConstraints:c,updateConstraint:R,deleteConstraintsConnected:function(e){c(r.filter((function(t){return!t.fromIds.includes(e)&&!t.methods.some((function(t){return t.toIds.includes(e)}))})))},deleteConstraint:function(e){var t=r.filter((function(t){return t.fromIds!==e.fromIds&&t.methods!==e.methods}));c(t),A(!1),W(!1)},createConstraint:function(e){if(0!==B.length){var n=e.filter((function(e){return B.includes(e.id)})),o={x:n.reduce((function(e,t){return e+t.x}),0)/n.length,y:n.reduce((function(e,t){return e+t.y}),0)/n.length,width:100,height:100,fromIds:B,methods:[]};P([]),c([].concat(Object(m.a)(r),[o])),A(!1),I(o)}else t.setError("No elements selected.")}},children:Object(p.jsx)(w.Provider,{value:{newConstraint:u,setNewConstraint:A,newMethod:f,setNewMethod:W},children:Object(p.jsx)(k.Provider,{value:{current:M,setCurrent:I,currentMethod:S,setCurrentMethod:N,updateMethod:function(e,t,n){var o=r.findIndex((function(e){return e===n}));return-1!==o?(r[o].methods=r[o].methods.map((function(n){return n.id===e.id?t:n})),c(r)):console.warn("Could not find method to update"),t},toggleElementToNewConstraint:function(e){B.includes(e)?P(B.filter((function(t){return t!==e}))):P([].concat(Object(m.a)(B),[e]))},toggleElementToNewMethod:function(e){B.includes(e)?P(B.filter((function(t){return t!==e}))):P([].concat(Object(m.a)(B),[e]))},createMethod:function(e){if(M){if(M.methods.some((function(e){return B.every((function(t){return e.toIds.includes(t)}))})))return t.setError("A method in the constraint already connects to the selected elements."),void P([]);if(0===B.length)return void t.setError("No elements selected.");if(null===M||void 0===M?void 0:M.methods.some((function(t){return t.id===e})))return void t.setError("Method with this name already exists");0===e.length&&(e="M".concat(++C));var n={id:e,type:i.VISUAL,code:"",toIds:B};P([]),N(n),W(!1);var o=[].concat(Object(m.a)(M.methods),[n]),r=F(o);I(R(M,Object(l.a)(Object(l.a)({},M),{},{methods:o,width:r>6?7*(r-6)+100:100,height:o.length>3?30*(o.length-3)+100:100})))}},deleteMethod:function(e){if(M){var t=M.methods.filter((function(t){return t.id!==e.id})),n=F(t);R(M,Object(l.a)(Object(l.a)({},M),{},{methods:t,width:n>6?7*(n-6)+100:100,height:t.length>3?30*(t.length-3)+100:100})),I(void 0)}},currentElements:B,cancelNewConstraint:function(){P([]),A(!1)},cancelNewMethod:function(){P([]),W(!1)}},children:e.children})})})};function I(){var e=Object(a.useContext)(y),t=e.constraints,n=e.setConstraints,o=e.updateConstraint,r=e.deleteConstraintsConnected,i=e.deleteConstraint,c=e.createConstraint,s=Object(a.useContext)(w),d=s.newConstraint,u=s.setNewConstraint,l=s.newMethod,b=s.setNewMethod,h=Object(a.useContext)(k),m=h.current,p=h.setCurrent,v=h.currentMethod,j=h.setCurrentMethod,f=h.updateMethod,x=h.toggleElementToNewConstraint,O=h.toggleElementToNewMethod;return{constraints:t,setConstraints:n,updateConstraint:o,newConstraint:d,setNewConstraint:u,deleteConstraint:i,current:m,setCurrent:p,deleteConstraintsConnected:r,currentMethod:v,setCurrentMethod:j,updateMethod:f,createConstraint:c,currentElements:h.currentElements,toggleElementToNewConstraint:x,cancelNewConstraint:h.cancelNewConstraint,cancelNewMethod:h.cancelNewMethod,newMethod:l,setNewMethod:b,toggleElementToNewMethod:O,createMethod:h.createMethod,deleteMethod:h.deleteMethod}}var E=s.a.createContext({}),T=function(e){var t=Object(a.useState)(i.VISUAL),n=Object(b.a)(t,2),o=n[0],r=n[1];return Object(p.jsx)(E.Provider,{value:{type:o,setType:r},children:e.children})};function S(){var e=Object(a.useContext)(E);return{type:e.type,setType:e.setType}}var N=s.a.createContext({}),L=s.a.createContext({}),D=s.a.createContext({}),B=s.a.createContext({}),P=[{label:"AddWith",inputs:[{variable:"num"}],output:"AddWith",params:[{name:"textBox",type:"number"}],codeLine:"num + textBox"},{label:"Add",inputs:[{variable:"num1"},{variable:"num2"}],output:"Add",params:[],codeLine:"num1 + num2"},{label:"DivWith",inputs:[{variable:"dividend"}],output:"DivWith",params:[{name:"divisor",type:"number"}],codeLine:"dividend + divisor"},{label:"Division",inputs:[{variable:"divisor"},{variable:"dividend"}],output:"Division",params:[],codeLine:"dividend / divisor"},{label:"SubtractWith",inputs:[{variable:"num1"}],output:"SubtractWith",params:[{name:"num2",type:"number"}],codeLine:"num1 - num2"},{label:"Subtract",inputs:[{variable:"num1"},{variable:"num2"}],output:"Subtract",params:[],codeLine:"num1 - num2"},{label:"MultWith",inputs:[{variable:"num1"}],output:"MultWith",params:[{name:"multiplier",type:"number"}],codeLine:"num1 * multiplier"},{label:"Multiplication",inputs:[{variable:"num1"},{variable:"num2"}],output:"Multiplication",params:[],codeLine:"num1 * num2"},{label:"ModWith",inputs:[{variable:"dividend"}],output:"ModWith",params:[{name:"divisor",type:"number"}],codeLine:"dividend % divisor"},{label:"Modulo",inputs:[{variable:"divisor"},{variable:"dividend"}],output:"Modulo",params:[],codeLine:"dividend % divisor"},{label:"LessThan",inputs:[{variable:"num1"},{variable:"num2"}],output:"LessThan",params:[],codeLine:"num1 < num2"},{label:"MoreThan",inputs:[{variable:"num1"},{variable:"num2"}],output:"MoreThan",params:[],codeLine:"num1 > num2"},{label:"LessOrEqual",inputs:[{variable:"num1"},{variable:"num2"}],output:"LessOrEqual",params:[],codeLine:"num1 <= num2"},{label:"MoreOrEqual",inputs:[{variable:"num1"},{variable:"num2"}],output:"MoreOrEqual",params:[],codeLine:"num1 >= num2"},{label:"IsPositive",inputs:[{variable:"num"}],output:"IsPositive",params:[],codeLine:"num > 0"},{label:"IsNegative",inputs:[{variable:"num"}],output:"IsNegative",params:[],codeLine:"num < 0"},{label:"IsZero",inputs:[{variable:"num"}],output:"IsZero",params:[],codeLine:"num === 0"},{label:"IsOdd",inputs:[{variable:"num"}],output:"IsOdd",params:[],codeLine:"num % 2 === 1"},{label:"IsEven",inputs:[{variable:"num"}],output:"IsEven",params:[],codeLine:"num % 2 === 0"},{label:"Min",inputs:[{variable:"num1"},{variable:"num2"}],output:"Min",params:[],codeLine:"Math.min(num1, num2)"},{label:"Max",inputs:[{variable:"num1"},{variable:"num2"}],output:"Max",params:[],codeLine:"Math.max(num1, num2)"},{label:"Length",inputs:[{variable:"str"}],output:"Length",params:[],codeLine:"str.length"},{label:"Concat",inputs:[{variable:"str"}],output:"Concat",params:[],codeLine:"textBox.concat(str)"},{label:"Contains",inputs:[{variable:"str"}],output:"Contains",params:[{name:"textBox",type:"text"}],codeLine:"str.contains(textBox)"},{label:"ToLowerCase",inputs:[{variable:"str"}],output:"ToLowerCase",params:[],codeLine:"str.toLowerCase()"},{label:"ToUpperCase",inputs:[{variable:"str"}],output:"ToUpperCase",params:[],codeLine:"str.toUpperCase()"},{label:"IsEmpty",inputs:[{variable:"str"}],output:"IsEmpty",params:[],codeLine:'str === "" || str === undefined'},{label:"And",inputs:[{variable:"bool1"},{variable:"bool2"}],output:"And",params:[],codeLine:'(bool1 === "true") && (bool2 === "true")'},{label:"Or",inputs:[{variable:"bool1"},{variable:"bool2"}],output:"Or",params:[],codeLine:'(bool1 === "true") || (bool2 === "true")'},{label:"Not",inputs:[{variable:"bool"}],output:"Not",params:[],codeLine:"!bool"},{label:"IsTrue",inputs:[{variable:"bool"}],output:"IsTrue",params:[],codeLine:'bool === "true"'},{label:"IsFalse",inputs:[{variable:"bool"}],output:"IsFalse",params:[],codeLine:'bool === "false"'},{label:"IsBefore",inputs:[{variable:"time"}],output:"IsBefore",params:[{name:"timeBox",type:"date"}],codeLine:"new Date(time).getTime() < new Date(timeBox).getTime()"},{label:"IsAfter",inputs:[{variable:"time"}],output:"IsAfter",params:[{name:"timeBox",type:"date"}],codeLine:"new Date(time).getTime() > new Date(timeBox).getTime()"}];var A=function(e){var t=Object(a.useState)(function(e){var t=0;return e.map((function(e){var n=e.codeLine;return e.inputs=e.inputs.map((function(e,t){return{id:t,variable:e.variable}})),e.outputs=[{id:0,variable:e.output}],e.params=e.params.map((function(e,t){return{id:t,name:e.name,type:e.type}})),e.id="lib-"+t++,e.code=function(t,o){var r;return e.inputs.forEach((function(e,o){var r,i,c,a,s;console.log(e.variable),console.log(null===(r=t[o])||void 0===r||null===(i=r.fromSocket)||void 0===i?void 0:i.variable),n=n.replace(e.variable,null!==(c=null===(a=t[o])||void 0===a||null===(s=a.fromSocket)||void 0===s?void 0:s.variable)&&void 0!==c?c:e.variable)})),t.length>=1&&1===(null===(r=o.outputs)||void 0===r?void 0:r.length)?"const ".concat(o.outputs[0].variable," = ").concat(n,"\n"):""},e}))}(P)),n=Object(b.a)(t,2),o=n[0],r=n[1],i=Object(a.useState)([]),c=Object(b.a)(i,2),s=c[0],d=c[1],u=Object(a.useState)([]),l=Object(b.a)(u,2),h=l[0],v=l[1];return Object(p.jsx)(N.Provider,{value:{components:s,setComponents:d,updateComponent:function(e,t){var n=s.findIndex((function(t){return t.id===e.id})),o=Object(m.a)(s);o[n]=t,d(o)},getComponentById:function(e){return s.find((function(t){return t.id===e}))},deleteComponent:function(e){var t=s.filter((function(t){return e.id!==t.id})),n=h.filter((function(t){var n,o;return e.id!==(null===(n=t.fromSocket)||void 0===n?void 0:n.id)&&e.id!==(null===(o=t.toSocket)||void 0===o?void 0:o.id)}));d(t),v(n)}},children:Object(p.jsx)(L.Provider,{value:{connections:h,setConnections:v,deleteConnection:function(e){var t=h.filter((function(t){return e.fromComponentId!==t.fromComponentId&&e.toComponentId!==t.toComponentId}));v(t)}},children:Object(p.jsx)(D.Provider,{value:{libraryComponents:o,setLibraryComponents:r},children:Object(p.jsx)(B.Provider,{value:{toObject:function(){return[s,h]},fromObject:function(e){e?(d(e[0]),v(e[1])):(d([]),v([]))}},children:e.children})})})})};function W(){var e=Object(a.useContext)(D),t=e.libraryComponents,n=e.setLibraryComponents,o=Object(a.useContext)(N),r=o.components,i=o.setComponents,c=o.updateComponent,s=o.getComponentById,d=o.deleteComponent,u=Object(a.useContext)(L),l=u.connections,b=u.setConnections,h=u.deleteConnection,m=Object(a.useContext)(B);return{libraryComponents:t,setLibraryComponents:n,components:r,setComponents:i,updateComponent:c,deleteComponent:d,connections:l,setConnections:b,deleteConnection:h,getComponentById:s,toObject:m.toObject,fromObject:m.fromObject}}var F=n(13),R=function(e){var t,n,o,r,i=e.component,c=e.socket,a=e.index,s=e.output,d=e.setNewConnection,u=e.connection;return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(h.b,{x:s?i.width:0,y:Object(F.d)(i,a,s?null===(t=i.outputs)||void 0===t?void 0:t.length:null===(n=i.inputs)||void 0===n?void 0:n.length),radius:10,fill:"#EF4444",onClick:function(){(null===u||void 0===u?void 0:u.fromComponentId)===i.id?d(null):(null===u||void 0===u?void 0:u.fromComponentId)&&!s?d(Object(l.a)(Object(l.a)({},u),{},{toComponentId:i.id,toSocketIndex:a,toSocket:c})):s&&d(Object(l.a)(Object(l.a)({},u),{},{fromComponentId:i.id,fromSocketIndex:a,fromSocket:c}))}}),Object(p.jsx)(h.i,{text:c.variable,x:s?i.width+15:15,y:Object(F.d)(i,a,s?null===(o=i.outputs)||void 0===o?void 0:o.length:null===(r=i.inputs)||void 0===r?void 0:r.length)-5})]})},U=n(81),K=function(e){var t,n,o,r,i,c=e.component,a=e.updateComponent,s=e.deleteComponent,d=e.setNewConnection,u=e.connection;return Object(p.jsxs)(h.c,{x:c.x,y:c.y,draggable:!0,onDragMove:function(e){a(c,Object(l.a)(Object(l.a)({},c),{},{x:e.target.x(),y:e.target.y()}))},children:[c.params&&c.params.length>0&&1===(null===(t=c.inputs)||void 0===t?void 0:t.length)&&Object(p.jsx)(U.a,{divProps:{style:{pointerEvents:"none"}},children:Object(p.jsx)("input",{value:c.value,onChange:function(e){a(c,Object(l.a)(Object(l.a)({},c),{},{value:e.target.value}))},placeholder:null===(n=c.params[0])||void 0===n?void 0:n.name,type:null===(o=c.params[0])||void 0===o?void 0:o.type,style:{width:100,marginLeft:c.width/4,marginTop:c.height/2,pointerEvents:"all"}})}),Object(p.jsx)(h.f,{width:c.width,height:c.height,fill:"white",shadowColor:"gray",shadowBlur:2,cornerRadius:10}),Object(p.jsxs)(h.c,{children:[Object(p.jsx)(h.i,{x:10,y:10,fill:"gray",fontStyle:"bold",text:c.label,fontSize:20}),null===(r=c.inputs)||void 0===r?void 0:r.map((function(e,t){return Object(p.jsx)(R,{component:c,socket:e,index:t,output:!1,setNewConnection:d,connection:u},t)})),null===(i=c.outputs)||void 0===i?void 0:i.map((function(e,t){return Object(p.jsx)(R,{component:c,socket:e,index:t,output:!0,setNewConnection:d,connection:u},t)}))]}),Object(p.jsx)(h.g,{x:c.width,y:0,fill:"red",stroke:"red",strokeWidth:5,sceneFunc:function(e,t){e.beginPath(),e.moveTo(0,0),e.lineTo(-10,10),e.moveTo(-10,0),e.lineTo(0,10),e.closePath(),e.fillStrokeShape(t)},onClick:function(){s(c)}})]})},V=function(e){var t,n,o,r,i,c,s=e.connection,d=e.getComponentById,u=e.deleteConnection,l=Object(a.useState)("black"),m=Object(b.a)(l,2),v=m[0],j=m[1],f=d(null!==(t=s.fromComponentId)&&void 0!==t?t:""),x=d(null!==(n=s.toComponentId)&&void 0!==n?n:"");return void 0===f||void 0===x?null:Object(p.jsx)(h.e,{onMouseEnter:function(){j("red")},onMouseLeave:function(){j("black")},onClick:function(){u(s)},points:[f.x+f.width,Object(F.d)(f,null!==(o=s.fromSocketIndex)&&void 0!==o?o:0,null===(r=f.outputs)||void 0===r?void 0:r.length,!0),x.x,Object(F.d)(x,null!==(i=s.toSocketIndex)&&void 0!==i?i:0,null===(c=x.inputs)||void 0===c?void 0:c.length,!0)],stroke:v,strokeWidth:5,lineCap:"round",lineJoin:"round"})},J=function(){var e,t,n,o,r,i,c,d,u,v=W(),j=Object(a.useState)(null),f=Object(b.a)(j,2),O=f[0],g=f[1],_=Object(a.useState)(null),C=Object(b.a)(_,2),y=C[0],w=C[1],k=I(),M=x(),E=Object(a.useState)(""),T=Object(b.a)(E,2),S=T[0],N=T[1],L=s.a.useRef(null),D=Object(a.useState)({x:0,y:0}),B=Object(b.a)(D,2),P=B[0],A=B[1];return Object(a.useEffect)((function(){L.current&&A({x:null===L||void 0===L?void 0:L.current.getBoundingClientRect().x,y:null===L||void 0===L?void 0:L.current.getBoundingClientRect().y})}),[L]),Object(a.useEffect)((function(){(null===O||void 0===O?void 0:O.fromComponentId)&&O.toComponentId&&(v.setConnections([].concat(Object(m.a)(v.connections),[O])),g(null))}),[O]),Object(a.useEffect)((function(){if(0===v.components.length){var e,t,n,o,r,i,c,a,s,d,u=M.getElementById(null!==(e=null===(t=k.currentMethod)||void 0===t?void 0:t.toIds[0])&&void 0!==e?e:"");v.setComponents([].concat(Object(m.a)(null!==(n=null===(o=k.current)||void 0===o?void 0:o.fromIds.map((function(e,t){var n,o=M.getElementById(e),r=null!==(n=null===o||void 0===o?void 0:o.type)&&void 0!==n?n:"";return{id:"".concat(Object(F.e)(r),"-").concat(e,"-").concat(Math.random().toString(36).substring(2,15)),label:"Input: ".concat(e),x:100,y:200*t+20,width:150,height:150,outputs:[{id:"output-".concat(t),variable:e,label:"Output: ".concat(e)}],code:function(e,t){return""}}})))&&void 0!==n?n:[]),[null!==(r={id:"".concat(Object(F.e)(null!==(i=null===u||void 0===u?void 0:u.type)&&void 0!==i?i:""),"-").concat(null===(c=k.currentMethod)||void 0===c?void 0:c.toIds[0],"-").concat(Math.random().toString(36).substring(2,15)),label:"Output: ".concat(null===(a=k.currentMethod)||void 0===a?void 0:a.toIds[0]),x:550,y:170,width:150,height:150,inputs:[{id:"input",variable:null!==(s=null===(d=k.currentMethod)||void 0===d?void 0:d.toIds[0])&&void 0!==s?s:""}],code:function(e,t){var n,o;return 1===e.length?"return ".concat(null!==(n=null===(o=e[0].fromSocket)||void 0===o?void 0:o.variable)&&void 0!==n?n:"",";\n"):""}})&&void 0!==r?r:[]]))}}),[v.components]),Object(p.jsxs)("div",{className:"flex flex-row",children:[Object(p.jsxs)("div",{className:"w-60 bg-gray p-3",children:[Object(p.jsx)("label",{children:"Search: "}),Object(p.jsx)("input",{className:"border border-black w-32",onChange:function(e){return N(e.target.value)}}),Object(p.jsx)("div",{className:"overflow-y-scroll",style:{height:"500px"},children:v.libraryComponents.filter((function(e){return e.label.toLowerCase().includes(S.toLowerCase())})).map((function(e){var t,n;return Object(p.jsxs)("div",{style:{width:"100",height:"100",backgroundColor:"white"},className:"border shadow p-4 m-4 h-32 rounded-lg font-bold",draggable:!0,onDragEnd:function(t){v.setComponents([].concat(Object(m.a)(v.components),[Object(l.a)(Object(l.a)({},e),{},{id:e.id+Math.random().toString(36).substring(2,15),width:150,height:150,x:t.pageX-400,y:t.pageY-200})]))},children:[e.label,Object(p.jsxs)("div",{className:"font-light",children:["\nInputs:"+(null===(t=e.inputs)||void 0===t?void 0:t.length),"\nOutputs:"+(null===(n=e.outputs)||void 0===n?void 0:n.length)]})]},e.id)}))})]}),Object(p.jsx)("div",{ref:function(e){return L.current=e},children:Object(p.jsxs)(h.h,{width:750,height:500,className:"bg-gray-100",onMouseMove:function(e){w({x:e.evt.clientX-P.x-5,y:e.evt.clientY-P.y-5})},children:[Object(p.jsx)(h.d,{children:v.components.map((function(e){return Object(p.jsx)(K,{component:e,updateComponent:v.updateComponent,deleteComponent:v.deleteComponent,setNewConnection:g,connection:O},e.id)}))}),Object(p.jsxs)(h.d,{children:[v.connections.map((function(e,t){return Object(p.jsx)(V,{connection:e,getComponentById:v.getComponentById,deleteConnection:v.deleteConnection},t)})),O&&Object(p.jsx)(h.e,{points:[null!==(e=(null===(t=v.getComponentById(null!==(n=O.fromComponentId)&&void 0!==n?n:""))||void 0===t?void 0:t.x)+(null===(o=v.getComponentById(null!==(r=O.fromComponentId)&&void 0!==r?r:""))||void 0===o?void 0:o.width))&&void 0!==e?e:0,Object(F.d)(v.getComponentById(null!==(i=O.fromComponentId)&&void 0!==i?i:""),O.fromSocketIndex,null===(c=v.getComponentById(null!==(u=O.fromComponentId)&&void 0!==u?u:""))||void 0===c||null===(d=c.outputs)||void 0===d?void 0:d.length,!0),y.x,y.y],strokeWidth:6,stroke:"black",lineCap:"round",lineJoin:"round"})]})]})})]})},q=n(80),Y=function(){var e,t,n,o,r=I(),c=S(),s=Object(a.useRef)(null);return Object(a.useEffect)((function(){return function(){var e;null===(e=s.current)||void 0===e||e.dispose()}}),[s]),Object(p.jsxs)("div",{className:"flex h-96 flex-col",children:[Object(p.jsxs)("p",{className:"p-2",children:[Object(p.jsx)("b",{children:"Variables in scope:"})," ",null===(e=r.current)||void 0===e?void 0:e.fromIds.join(", ")," ",Object(p.jsx)("b",{children:"Output variables:"})," ",null===(t=r.currentMethod)||void 0===t?void 0:t.toIds.join(", ")]}),Object(p.jsx)(q.a,{height:"100%",defaultLanguage:"javascript",defaultValue:null!==(n=null===(o=r.currentMethod)||void 0===o?void 0:o.code)&&void 0!==n?n:"",beforeMount:function(e){var t;e.editor.EditorOptions.formatOnType.defaultValue=!0;var n="\n        ".concat(null===(t=r.current)||void 0===t?void 0:t.fromIds.map((function(e){return"declare var ".concat(e,": any;")})).join("\n"),"\n        ");e.languages.typescript.javascriptDefaults.addExtraLib(n,"ts:filename/inputs.d.ts")},onChange:function(e,t){r.current&&r.currentMethod&&c.type===i.CODE&&r.setCurrentMethod(r.updateMethod(r.currentMethod,Object(l.a)(Object(l.a)({},r.currentMethod),{},{code:null!==e&&void 0!==e?e:"",type:i.CODE,visualJson:void 0}),r.current))},onMount:function(e){s.current=e}})]})},X=function(e){var t=e.open,n=e.onClose,o=I(),r=S(),c=W(),d=s.a.useState({x:0,y:0}),u=Object(b.a)(d,2),h=u[0],m=u[1],v=s.a.useState({x:200,y:200}),j=Object(b.a)(v,2),f=j[0],x=j[1];return Object(a.useEffect)((function(){var e,t,n;r.setType(null!==(e=null===(t=o.currentMethod)||void 0===t?void 0:t.type)&&void 0!==e?e:i.VISUAL),c.fromObject(null===(n=o.currentMethod)||void 0===n?void 0:n.visualJson)}),[o.currentMethod]),Object(p.jsx)(p.Fragment,{children:t&&o.current&&Object(p.jsx)("div",{style:{left:f.x,top:f.y,width:"1000px",height:"600px",position:"fixed",backgroundColor:"white",zIndex:1},children:Object(p.jsxs)("div",{className:"bg-white",children:[Object(p.jsxs)("div",{className:"bg-gray-200",onDragStart:function(e){m({x:e.clientX-f.x,y:e.clientY-f.y})},onDrag:function(e){0===e.clientX&&0===e.clientY||x({x:e.clientX-h.x,y:e.clientY-h.y})},children:[Object(p.jsx)("button",{className:"p-5 bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded disabled:opacity-50 m-1",onClick:function(){return r.setType(i.VISUAL)},children:"Visual"}),Object(p.jsx)("button",{className:"p-5 bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded disabled:opacity-50 m-1",onClick:function(){return r.setType(i.CODE)},children:"Code"}),Object(p.jsx)("button",{className:"p-5 float-right bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded disabled:opacity-50 m-1",onClick:function(){var e;if((null===(e=o.currentMethod)||void 0===e?void 0:e.type)===i.VISUAL){var t,r,a=function(e,t){var n="";return e.sort((function(e,t){return e.x<t.x?-1:e.x>t.x?1:0})).forEach((function(e){var o,r,i=t.filter((function(t){return t.toComponentId===e.id}));i.length>0&&(null!==(o=null===e||void 0===e||null===(r=e.params)||void 0===r?void 0:r.length)&&void 0!==o&&o&&(n+="const ".concat(e.params[0].name,' = "').concat(e.value,'";\n')),n+=e.code(i,e))})),n}(null!==(t=c.components)&&void 0!==t?t:[],null!==(r=c.connections)&&void 0!==r?r:[]);console.log(a),o.current&&o.currentMethod&&o.updateMethod(o.currentMethod,Object(l.a)(Object(l.a)({},o.currentMethod),{},{code:a,visualJson:c.toObject()}),o.current),c.setConnections([]),c.setComponents([]),o.setCurrent(void 0),o.setCurrentMethod(void 0)}n()},children:"Save"})]}),Object(p.jsx)("div",{style:r.type===i.VISUAL?{}:{display:"none"},className:"editor bg-white",children:Object(p.jsx)(J,{})}),Object(p.jsx)("div",{style:r.type===i.CODE?{}:{display:"none"},children:Object(p.jsx)(Y,{})})]})})})};function z(e){var t=s.a.useRef(null),n=s.a.useRef(null);return s.a.useEffect((function(){var o,r;e&&(null===n||void 0===n||null===(o=n.current)||void 0===o||o.nodes([t.current]),null===n||void 0===n||null===(r=n.current)||void 0===r||r.getLayer().batchDraw())}),[e]),[t,n]}var H=function(e){var t=e.trRef;return Object(p.jsx)(h.j,{ref:function(e){return t.current=e},rotateEnabled:!1,boundBoxFunc:function(e,t){return t.width<10||t.height<10?e:t}})},Z=function(e){var t=e.element,n=e.onClick,o=e.onDragMove,r=e.isSelected,i=e.onTransform,c=e.onTransformEnd,a=e.chooseStrokeColor,s=z(r),d=Object(b.a)(s,2),u=d[0],l=d[1];return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(h.c,{children:Object(p.jsx)(h.f,{ref:function(e){return u.current=e},width:t.width,height:t.height,draggable:!0,x:t.x,y:t.y,fill:"white",stroke:a(t),strokeWidth:"blue"===a(t)?3:1,cornerRadius:10,onClick:function(){return n(t)},onDragMove:function(e){return o(e,t)},onTransform:function(e){return i(e,u.current)},onTransformEnd:function(e){return c(e,u.current,t)}})}),r&&Object(p.jsx)(H,{trRef:l})]})},G=function(e){var t=e.element,n=e.onClick,o=e.onDragMove,r=e.isSelected,i=e.onTransform,c=e.onTransformEnd,a=e.chooseStrokeColor,s=z(r),d=Object(b.a)(s,2),u=d[0],l=d[1];return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsxs)(h.c,{ref:function(e){return u.current=e},x:t.x,y:t.y,draggable:!0,onClick:function(){return n(t)},onDragMove:function(e){return o(e,t)},children:[Object(p.jsx)(h.f,{width:t.width,height:t.height,fill:a(t),cornerRadius:10,onTransform:function(e){return i(e,u.current)},onTransformEnd:function(e){return c(e,u.current,t)}}),Object(p.jsx)(h.i,{text:t.value,fill:"white",align:"center",width:t.width,padding:15,fontSize:16})]}),r&&Object(p.jsx)(H,{trRef:l})]})},Q=function(e){var t=e.element,n=e.onClick,o=e.onDragMove,r=e.chooseStrokeColor;return Object(p.jsx)(h.i,{text:t.value,fill:r(t),align:"left",width:12*t.value.length+30,height:t.height,padding:15,fontSize:16,draggable:!0,x:t.x,y:t.y,onClick:function(){return n(t)},onDragMove:function(e){return o(e,t)}})},$=window.screen.availWidth-750,ee=window.innerHeight,te=10;function ne(e,t){e.target.x(Object(F.a)(e.target.x(),$-t.width)),e.target.x(Math.round(e.target.x()/te)*te),e.target.y(Object(F.a)(e.target.y(),ee-t.height)),e.target.y(Math.round(e.target.y()/te)*te)}function oe(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=e.x,r=e.y,i=t.x,c=t.y,a=e.height,s=t.height,d=e.width,u=t.width;function l(e,t,n){return e/2+Math.max(Math.min(e/2,(t-n)/2),-e/2)}return Math.abs(o-i)>Math.abs(r-c)?o<i?(c+=l(s,r,c),r+=a/2,o+=d,i-=n):o>i&&(c+=l(s,r,c),r+=a/2,i+=u,i+=n):r<c?(i+=l(u,o,i),o+=d/2,r+=a,c-=n):r>c&&(i+=l(u,o,i),o+=d/2,c+=s,c+=n),[o,r,i,c]}var re=function(){return Object(p.jsxs)(h.d,{children:[Array.from(Array(ee).keys()).filter((function(e){return e%te===0})).map((function(e){return Object(p.jsx)(h.e,{points:[0,e,$,e],width:$,stroke:"gray",strokeWidth:.5},e)})),Array.from(Array($).keys()).filter((function(e){return e%te===0})).map((function(e){return Object(p.jsx)(h.e,{points:[e,0,e,ee],width:$,stroke:"gray",strokeWidth:.5},e)}))]})},ie=function(e){var t=e.constraints,n=e.constraint,o=e.elements,r=e.onClick,i=e.selected,c=z(i),a=Object(b.a)(c,2),s=a[0],d=a[1];return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(h.f,{ref:function(e){return s.current=e},x:n.x,y:n.y,width:n.width,height:n.height,onClick:function(){t.setCurrent(n),t.setCurrentMethod(void 0),o.setCurrent(void 0),r(n)},cornerRadius:50,fill:"red",shadowBlur:3,shadowColor:"black",onDragMove:function(e){return function(e,n){t.setCurrent(t.updateConstraint(n,Object(l.a)(Object(l.a)({},n),{},{x:e.target.x(),y:e.target.y()})))}(e,n)},draggable:!0}),i&&Object(p.jsx)(h.j,{ref:function(e){return d.current=e},rotateEnabled:!1,resizeEnabled:!1,borderStrokeWidth:2})]})},ce=function(e){var t=e.id,n=e.constraints,o=e.constraint,r=e.elements,i=e.points,c=e.connection,a=e.hidden,s=e.selected;return Object(p.jsx)(p.Fragment,{children:c?Object(p.jsx)(h.e,{onClick:function(){n.setCurrent(o),r.setCurrent(void 0)},points:i,stroke:"red",fill:"red",opacity:a&&n.currentMethod?.3:n.current&&n.current===o?1:.3,strokeWidth:5,shadowBlur:3,shadowColor:"red"},t):Object(p.jsxs)(h.c,{children:[a&&n.currentMethod&&n.current===o&&Object(p.jsx)(h.e,{points:i,stroke:"red",fill:"red",opacity:1,strokeWidth:5,shadowBlur:3,shadowColor:"red"}),Object(p.jsx)(h.a,{onClick:function(){n.setCurrent(o),r.setCurrent(void 0)},points:i,stroke:"red",fill:"red",opacity:a&&n.currentMethod&&n.current===o?0:n.current&&n.current===o?1:.3,strokeWidth:5,shadowBlur:3,shadowColor:"red"},t),s&&Object(p.jsx)(h.e,{points:i,stroke:"red",fill:"red",opacity:1,strokeWidth:5,shadowBlur:3,shadowColor:"red"})]})})},ae=function(e){var t=e.constraint,n=e.elements,o=e.constraints,r=s.a.useState([]),i=Object(b.a)(r,2),c=i[0],d=i[1],u=s.a.useState([]),l=Object(b.a)(u,2),h=l[0],v=l[1];return Object(a.useEffect)((function(){var e=Array.from(new Set(Object(m.a)(t.methods.map((function(e){return e.toIds})).flat()))),n=t.fromIds.filter((function(e){return!t.methods.some((function(t){return t.toIds.includes(e)}))}));d(n),v(e)}),[t]),Object(p.jsxs)(p.Fragment,{children:[c.map((function(e){var r,i=n.getElementById(e);return void 0===i?(console.error("Constraint id, does not have matching canvas element: ".concat(e)),null):Object(p.jsx)(ce,{id:"From".concat(i.id),constraints:o,constraint:t,points:oe(t,i,0),elements:n,connection:!0,selected:o.current===t,hidden:null!==(r=o.current!==t)&&void 0!==r&&r},"From".concat(i.id))})),h.map((function(e){var r,i,c=n.getElementById(e);return void 0===c?(console.error("Constraint id, does not have matching canvas element: ".concat(e)),null):Object(p.jsx)(ce,{id:"To".concat(c.id),constraints:o,constraint:t,points:oe(t,c),elements:n,connection:!1,selected:o.current===t,hidden:null!==(r=!(null===(i=o.currentMethod)||void 0===i?void 0:i.toIds.includes(c.id)))&&void 0!==r&&r},"To".concat(c.id))}))]})},se=function(e){var t=e.setOpen,n=e.constraints,o=e.constraint,r=e.elements,i=e.method,c=e.index,a=e.onClick,d=s.a.useState(!1),u=Object(b.a)(d,2),l=u[0],m=u[1];return Object(p.jsxs)(h.c,{x:o.x+o.width/6,y:o.y+30*c+10,onClick:function(){n.newConstraint?a(i):(t(!0),n.setCurrent(o),n.setCurrentMethod(i),r.setCurrent(void 0))},onMouseOver:function(){n.setCurrentMethod(i),n.setCurrent(o),r.setCurrent(void 0),m(!0)},onMouseLeave:function(){m(!1)},children:[Object(p.jsx)(h.f,{width:o.width/1.5,cornerRadius:20,height:20,fill:l?"grey":"#fff",shadowBlur:4,shadowColor:"black"},i.id),Object(p.jsx)(h.i,{text:"".concat(i.id),fill:"black",fontFamily:"Open Sans",x:15,y:5})]})},de=function(e){var t=e.onClick,n=e.setOpen,o=e.constraints,r=e.elements;return Object(p.jsx)(h.d,{children:o.constraints.map((function(e,i){return Object(p.jsxs)(h.c,{children:[Object(p.jsx)(ie,{constraints:o,elements:r,onClick:t,constraint:e,selected:e===o.current}),e.methods.map((function(i,c){return Object(p.jsx)(se,{setOpen:n,constraint:e,constraints:o,elements:r,method:i,index:c,onClick:t},c)})),Object(p.jsx)(ae,{constraint:e,elements:r,constraints:o})]},i)}))})},ue=function(e){var t=e.element,n=e.onClick,o=e.onDragMove,r=e.isSelected,i=e.onTransform,c=e.onTransformEnd,a=e.chooseStrokeColor,s=z(r),d=Object(b.a)(s,2),u=d[0],l=d[1];return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(h.c,{children:Object(p.jsx)(h.f,{ref:function(e){return u.current=e},width:t.width,height:t.height,draggable:!0,x:t.x,y:t.y,fill:"white",stroke:a(t),strokeWidth:"blue"===a(t)?3:1,onClick:function(){return n(t)},onDragMove:function(e){return o(e,t)},onTransform:function(e){return i(e,u.current)},onTransformEnd:function(e){return c(e,u.current,t)}})}),r&&Object(p.jsx)(H,{trRef:l})]})},le=function(){var e=x(),t=I(),n=Object(a.useState)(!1),r=Object(b.a)(n,2),i=r[0],c=r[1];function s(e){var n;return t.currentElements.includes(e.id)&&(t.newMethod||t.newConstraint)?"blue":t.newConstraint||t.newMethod&&(null===(n=t.current)||void 0===n?void 0:n.fromIds.includes(e.id))?"green":"black"}function d(n){var o;t.newMethod&&(null===(o=t.current)||void 0===o?void 0:o.fromIds.includes(n.id))||t.newConstraint?t.toggleElementToNewConstraint(n.id):t.newMethod||(e.setCurrent(n),t.setCurrent(void 0))}function u(t,n){var o=e.getElementById(n.id);if(ne(t,n),!o)throw new Error("Could not find element to move");e.updateElement(o,Object(l.a)(Object(l.a)({},o),{},{x:t.target.x(),y:t.target.y()})),e.setCurrent(o)}function m(t,n){var o=null===n||void 0===n?void 0:n.scaleX(),r=null===n||void 0===n?void 0:n.scaleY();null===n||void 0===n||n.scaleX(1),null===n||void 0===n||n.scaleY(1),e.setCurrent(e.updateElement(e.current,Object(l.a)(Object(l.a)({},e.current),{},{x:t.target.x(),y:t.target.y(),width:Math.max(t.target.width()*o),height:Math.max(t.target.height()*r)})))}function v(e,t,n){!function(e){e.target.width(Math.round(e.target.width()/te)*te),e.target.height(Math.round(e.target.height()/te)*te)}(e),ne(e,n),m(e,t)}return Object(p.jsxs)("div",{className:"",children:[Object(p.jsxs)(h.h,{width:$,height:ee,className:"bg-gray-100",onClick:function(n){n.target===n.target.getStage()&&!i&&(e.setCurrent(void 0),t.setCurrent(void 0),t.setCurrentMethod(void 0),t.cancelNewConstraint(),t.cancelNewMethod())},children:[Object(p.jsx)(re,{}),Object(p.jsx)(de,{onClick:function(n){t.setCurrent(n),e.setCurrent(void 0)},setOpen:c,elements:e,constraints:t}),Object(p.jsx)(h.d,{children:e.elements.map((function(t,n){var r,i,c;switch(t.type){case o.Input:return Object(p.jsx)(Z,{element:t,onClick:d,onDragMove:u,isSelected:t.id===(null===(r=e.current)||void 0===r?void 0:r.id),onTransform:m,onTransformEnd:v,chooseStrokeColor:s},n);case o.Button:return Object(p.jsx)(G,{element:t,onClick:d,onDragMove:u,isSelected:t.id===(null===(i=e.current)||void 0===i?void 0:i.id),onTransform:m,onTransformEnd:v,chooseStrokeColor:s},n);case o.Text:return Object(p.jsx)(Q,{element:t,onClick:d,onDragMove:u,chooseStrokeColor:s},n);case o.Checkbox:return Object(p.jsx)(ue,{element:t,onClick:d,onDragMove:u,isSelected:t.id===(null===(c=e.current)||void 0===c?void 0:c.id),onTransform:m,onTransformEnd:v,chooseStrokeColor:s},n);default:return null}}))})]}),Object(p.jsx)(A,{children:Object(p.jsx)(X,{onClose:function(){c(!1)},open:i})})]})},be=function(e){return Object(p.jsx)("div",{className:"w-96 p-8 bg-gray-100",children:e.children})},he=450,me=function(){var e=x();function t(e){switch(e){case o.Button:return"button"+Fe();case o.Input:return"input"+Fe();case o.Text:return"text"+Fe();case o.Checkbox:return"checkbox"+Fe();default:return"id"+Fe()}}return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h1",{className:"font-bold text-lg",children:"Elements"}),Object(p.jsx)("div",{draggable:!0,className:"w-24 bg-white border border-black p-3 m-1 rounded",onDragEnd:function(n){e.addElement({id:t(o.Input),height:50,width:200,x:n.clientX-he,y:n.clientY,type:o.Input,binding:c.Value,subType:r.Text,value:""})},children:"Input"}),Object(p.jsx)("div",{draggable:!0,className:"w-24 bg-white border border-black p-3 m-1 rounded",onDragEnd:function(n){e.addElement({id:t(o.Button),height:50,width:150,x:n.clientX-he,y:n.clientY,type:o.Button,binding:c.Disabled,value:"Name"})},children:"Button"}),Object(p.jsx)("div",{draggable:!0,className:"w-24 text-black p-3 m-1 border border-black rounded",onDragEnd:function(n){e.addElement({id:t(o.Text),height:50,width:200,x:n.clientX-he,y:n.clientY,type:o.Text,binding:c.InnerText,value:"Textvalue"})},children:"Text"}),Object(p.jsx)("div",{draggable:!0,className:"w-24 text-black p-3 m-1 border border-black rounded",onDragEnd:function(n){e.addElement({id:t(o.Checkbox),height:30,width:30,x:n.clientX-he,y:n.clientY,type:o.Checkbox,binding:c.Checked,value:"false"})},children:"Checkbox"})]})},pe=n(25),ve=n.n(pe),je=n(76),fe=n(140),xe=n(34),Oe=n(4),ge=n(6),_e=n(20),Ce=function(){function e(){Object(Oe.a)(this,e),this.html="",this.add("<html>")}return Object(ge.a)(e,[{key:"add",value:function(e){return this.html+=e,this}},{key:"end",value:function(){return this.add("</html>"),this}},{key:"build",value:function(){return this.html}},{key:"includeHTML",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=Object(xe.a)(e);try{for(i.s();!(t=i.n()).done;){var c=t.value,a=c.type,s=c.x,d=c.y,u=c.value,l=c.subType,b=c.width,h=c.height,m=c.id;switch(a){case o.Input:this.add("<input \n                            id=".concat(m,"\n                            type=").concat(l,'\n                            style="\n                                 position:absolute;\n                                 top:').concat(d+r,"px;\n                                 left:").concat(s+n,"px;\n                                 width:").concat(b,"px;\n                                 height:").concat(h,'px;\n                                 border-radius: 10px;\n                                 border-style:solid;\n                                 border-width:1px;\n                                 border-color:black;\n                            "\n                            value="').concat(u,'"\n                            />'));break;case o.Button:this.add("<button \n                            id=".concat(m,'\n                            style="\n                                 position:absolute;\n                                 top:').concat(d+r,"px;\n                                 left:").concat(s+n,"px;\n                                 width:").concat(b,"px;\n                                 height:").concat(h,'px;\n                                 background-color:black;\n                                 color: white;\n                                 border-radius: 10px;\n                            "\n                         >').concat(u,"</button>"));break;case o.Text:this.add("<p\n                            id=".concat(m,'\n                            style="\n                                 position:absolute;\n                                 top:').concat(d+r+10,"px;\n                                 left:").concat(s+n+15,"px;\n                                 width:").concat(12*u.length+30,"px;\n                                 height:").concat(h,'px;\n                            "\n                         >').concat(u,"</p>"));break;case o.Checkbox:this.add("<input \n                            id=".concat(m,'\n                            type="checkbox"\n                            style="\n                                 position:absolute;\n                                 top:').concat(d+r,"px;\n                                 left:").concat(s+n,"px;\n                                 width:").concat(b,"px;\n                                 height:").concat(h,'px;\n                            "\n                            checked="').concat(u,'"\n                            />'))}}}catch(p){i.e(p)}finally{i.f()}return this}},{key:"includeHotDrink",value:function(){this.add('<script type="text/javascript" src="hotdrink.js"><\/script>')}},{key:"includeJS",value:function(e,t){this.includeHotDrink(),Object(F.c)(e,t);var n=Object(_e.constraintSystemToJson)(_e.defaultConstraintSystem);this.add("<script>"),this.add("async function run() { "),this.add("const system = hd.constraintSystemFromJson(".concat(JSON.stringify(n),");")),this.add("const comp = Array.from(system.allComponents())[0];"),this.add("function bind(value, element, type) {\n    value.value.subscribe({\n        next: val => {\n            if (val.hasOwnProperty('value')) {\n                element[type] = val.value;\n            }\n        }\n        });\n    element.addEventListener('input', () => {\n        value.value.set(element[type]);\n     });\n    }");var o,r=Object(xe.a)(e);try{for(r.s();!(o=r.n()).done;)for(var i=o.value,c=Array.from(new Set([].concat(Object(m.a)(i.fromIds),Object(m.a)(i.methods.map((function(e){return e.toIds})).flat())))),a=0,s=c;a<s.length;a++){var d=s[a],u=t.getElementById(d).binding;this.add('await comp.vs["'.concat(d,'"].currentPromise;')),this.add("system.update();"),this.add('bind(comp.vs["'.concat(d,'"], document.getElementById("').concat(d,'"), "').concat(u,'");'))}}catch(l){r.e(l)}finally{r.f()}return this.add("}"),this.add("run();"),this.add("<\/script>"),this}}]),e}(),ye=function(){var e=I(),t=x();return Object(a.useEffect)((function(){var n,o=new Ce;o.includeHTML(t.elements,200,100).end(),u.a.render(Object(p.jsx)("div",{id:"content",style:{height:"100%",width:"100%"},dangerouslySetInnerHTML:(n=o.build(),{__html:n})}),document.getElementById("index"),(function(){Object(F.c)(e.constraints,t)}))}),[e.constraints]),Object(p.jsx)("div",{id:"index"})},we=n(77),ke=n.n(we),Me=n(78),Ie=function(){var e=x(),t=I(),n=Object(a.useState)(!1),o=Object(b.a)(n,2),r=o[0],i=o[1];function c(){return(c=Object(je.a)(ve.a.mark((function n(){var o,r,i;return ve.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=new ke.a,(r=new Ce).includeHTML(e.elements).includeJS(t.constraints,e).end(),o.file("index.html",r.build()),n.next=6,fetch("/hd-visual2/hotdrink.js",{method:"GET"});case 6:return i=n.sent,n.t0=o,n.next=10,i.text();case 10:n.t1=n.sent,n.t0.file.call(n.t0,"hotdrink.js",n.t1),o.generateAsync({type:"blob"}).then((function(e){Object(Me.saveAs)(e,"program.zip")}));case 13:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h1",{className:"font-bold text-lg",children:"Actions"}),Object(p.jsx)("button",{className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded m-1",onClick:function(){return i(!0)},children:"Run"}),Object(p.jsx)("button",{className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded m-1",onClick:function(){return c.apply(this,arguments)},children:"Export"}),Object(p.jsx)(fe.a,{open:r,onBackdropClick:function(){return i(!1)},children:Object(p.jsx)("div",{className:"w-3/4 h-3/4 bg-gray-200 p-20 ml-auto mr-auto mt-20",children:Object(p.jsx)(ye,{})})})]})},Ee=function(e){var t=e.onCancel,n=e.onConfirm;return Object(p.jsxs)("div",{children:[Object(p.jsx)("button",{className:"h-10 bg-red-600 text-white p-2 m-2 rounded",onClick:t,children:"Cancel"}),Object(p.jsx)("button",{className:"h-10 bg-green-600 text-white p-2 m-2 rounded",onClick:n,children:"Confirm"})]})},Te=function(){var e=I(),t=x(),n=s.a.useState(""),o=Object(b.a)(n,2),r=o[0],i=o[1];return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h1",{className:"font-bold text-lg",children:"Constraints"}),Object(p.jsx)("button",{className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded disabled:opacity-50 m-1",onClick:function(){e.setNewConstraint(!0)},disabled:e.newConstraint,children:"Create constraint"}),e.newConstraint&&Object(p.jsx)(Ee,{onCancel:function(){return e.cancelNewConstraint()},onConfirm:function(){return e.createConstraint(t.elements)}}),Object(p.jsxs)("div",{children:[Object(p.jsx)("button",{className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded disabled:opacity-50 m-1",onClick:function(){return e.setNewMethod(!0)},disabled:e.newMethod||!e.current,children:"Create method"}),e.newMethod&&Object(p.jsxs)("div",{children:[Object(p.jsx)("label",{htmlFor:"name",children:"Method name:"}),Object(p.jsx)("input",{id:"name",onChange:function(e){return i(e.target.value)},className:"border"}),Object(p.jsx)(Ee,{onCancel:function(){return e.cancelNewMethod()},onConfirm:function(){e.createMethod(r),i("")}})]})]})]})},Se=function(){var e=_();return Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("div",{style:{position:"absolute",top:0,left:"30%",color:"black",fontSize:"20px",fontWeight:"bold",zIndex:100},children:e.message}),Object(p.jsx)("div",{style:{position:"absolute",top:"30px",left:"30%",color:"red",fontSize:"18px",fontWeight:"bold",zIndex:100},children:e.error})]})},Ne=function(e){return Object(p.jsx)("div",{className:"bg-white py-5 px-5 rounded mb-5 shadow",children:e.children})},Le=function(){var e=I();return Object(p.jsxs)(Ne,{children:[!e.current&&Object(p.jsx)("h1",{className:"font-bold",children:"No selected constraint"}),e.current&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h1",{className:"font-bold",children:"Constraint"}),Object.keys(e.current).map((function(t){return"fromIds"===t?Object(p.jsxs)("div",{className:"p-1",children:["InputElements: ",e.current[t].join(", ")]},t):"methods"!==t?Object(p.jsxs)("div",{className:"p-1",children:[Object(F.e)(t),": ",e.current[t]]},t):void 0})),Object(p.jsx)("button",{className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded disabled:opacity-50 m-1",onClick:function(){e.deleteConstraint(e.current),e.setCurrent(void 0)},children:"Delete constraint"})]})]})},De=n(9),Be=function(e){var t=e.elemKey,n=e.type,o=x();return Object(p.jsxs)("div",{className:"flex p-1",children:[Object(p.jsxs)("div",{children:[Object(F.e)(t),": "]}),Object(p.jsx)("select",{className:"m-1 rounded-md border border-gray-300 bg-white",value:o.current[t],onChange:function(e){o.setCurrent(o.updateElement(o.current,Object(l.a)(Object(l.a)({},o.current),{},Object(De.a)({},t,e.target.value))))},children:Object.keys(n).map((function(e,t){return Object(p.jsx)("option",{value:Object(F.b)(e),children:e},t)}))})]},t)},Pe=function(){var e=x(),t=I(),n=["value","height","width","id"];function o(t,n,o){e.setCurrent(e.updateElement(e.current,Object(l.a)(Object(l.a)({},e.current),{},Object(De.a)({},n,o?parseInt(t.target.value):t.target.value))))}return Object(p.jsxs)(Ne,{children:[!e.current&&Object(p.jsx)("h1",{className:"font-bold",children:"No selected element"}),e.current&&Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("h1",{className:"font-bold",children:"Element"}),Object.keys(e.current).map((function(i){return n.includes(i)?Object(p.jsxs)("div",{className:"p-1",children:[Object(p.jsxs)("label",{className:"w-20",children:[Object(F.e)(i),": "]}),Object(p.jsx)("input",{value:e.current[i],onChange:function(n){"id"===i?function(n,r){e.elements.find((function(e){return e.id===n.target.value}))?alert("Element with this id already exists"):(o(n,"id"),t.constraints.forEach((function(e){(e.methods.some((function(e){return e.toIds.includes(r)}))||e.fromIds.includes(r))&&t.updateConstraint(e,Object(l.a)(Object(l.a)({},e),{},{fromIds:e.fromIds.map((function(e){return e===r?n.target.value:e})),methods:e.methods.map((function(e){return e.toIds.includes(r)?Object(l.a)(Object(l.a)({},e),{},{toIds:e.toIds.map((function(e){return e===r?n.target.value:e})),code:e.code.replaceAll(r,n.target.value)}):Object(l.a)(Object(l.a)({},e),{},{code:e.code.replaceAll(r,n.target.value)})}))}))})))}(n,e.current.id):o(n,i)},className:"border w-20 rounded"})]},i):"subType"===i?Object(p.jsx)(Be,{elemKey:i,type:r},i):"binding"===i?Object(p.jsx)(Be,{elemKey:i,type:c},i):"type"===i?Object(p.jsxs)("div",{className:"p-1",children:["ElementKind",": ",e.current[i]]},i):Object(p.jsxs)("div",{className:"p-1",children:[Object(F.e)(i),": ",e.current[i]]},i)})),Object(p.jsx)("button",{className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded disabled:opacity-50 m-1",onClick:function(){e.deleteElement(e.current.id),t.deleteConstraintsConnected(e.current.id),e.setCurrent(void 0)},children:"Delete element"})]})]})},Ae=function(){var e=I(),t=Object(a.useState)(!1),n=Object(b.a)(t,2),o=n[0],r=n[1];return Object(p.jsxs)(p.Fragment,{children:[e.current&&Object(p.jsx)(Ne,{children:Object(p.jsxs)(p.Fragment,{children:[0===e.current.methods.length?Object(p.jsx)("h1",{className:"font-bold",children:"No methods in constraints"}):Object(p.jsx)("h1",{className:"font-bold",children:"Methods"}),Object(p.jsx)("div",{children:e.current.methods.map((function(t){return Object(p.jsxs)("div",{children:[t.id+": ",Object(p.jsx)("button",{onClick:function(){e.setCurrentMethod(t),r(!0)},className:"m-1 p-1 bg-red-500 hover:bg-red-700 text-white font-bold px-1 rounded",children:"Edit"}),Object(p.jsx)("button",{onClick:function(){e.deleteMethod(t)},className:"m-1 p-1 bg-red-500 hover:bg-red-700 text-white font-bold px-1 rounded",children:"Delete"})]},t.id)}))})]})}),Object(p.jsx)(A,{children:Object(p.jsx)(X,{onClose:function(){r(!1)},open:o})})]})},We=0;function Fe(){return++We}var Re=function(){return Object(p.jsx)(g,{children:Object(p.jsx)(f,{children:Object(p.jsx)(M,{children:Object(p.jsx)(T,{children:Object(p.jsxs)("div",{className:"flex space-x-3 max-h-full",children:[Object(p.jsx)(Se,{}),Object(p.jsxs)(be,{children:[Object(p.jsx)(Ne,{children:Object(p.jsx)(me,{})}),Object(p.jsx)(Pe,{})]}),Object(p.jsx)("div",{className:"flex-1",children:Object(p.jsx)(le,{})}),Object(p.jsxs)(be,{children:[Object(p.jsx)(Ne,{children:Object(p.jsx)(Te,{})}),Object(p.jsx)(Le,{}),Object(p.jsx)(Ae,{}),Object(p.jsx)("div",{className:"absolute bottom-10",children:Object(p.jsx)(Ne,{children:Object(p.jsx)(Ie,{})})})]})]})})})})})},Ue=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,141)).then((function(t){var n=t.getCLS,o=t.getFID,r=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),o(e),r(e),i(e),c(e)}))};u.a.render(Object(p.jsx)(s.a.StrictMode,{children:Object(p.jsx)(Re,{})}),document.getElementById("root")),Ue()},13:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return runJs})),__webpack_require__.d(__webpack_exports__,"e",(function(){return upperCaseFirst})),__webpack_require__.d(__webpack_exports__,"b",(function(){return lowerCaseFirst})),__webpack_require__.d(__webpack_exports__,"a",(function(){return clamp})),__webpack_require__.d(__webpack_exports__,"d",(function(){return socketYAxisPlacement}));var _home_db_skole_hd_visual2_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(10),_home_db_skole_hd_visual2_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(34),hotdrink__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(20),hotdrink__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(hotdrink__WEBPACK_IMPORTED_MODULE_2__),idToValue=new Map,valueToId=new Map;function DOMBind(e,t,n){var o;if(null===e)throw Error("DOM Element is null");var r=null===t||void 0===t||null===(o=t.value)||void 0===o?void 0:o.subscribe({next:function(t){t.hasOwnProperty("value")&&(e[n]=t.value)}});function i(){var o;null===t||void 0===t||null===(o=t.value)||void 0===o||o.set(e[n])}return null===e||void 0===e||e.addEventListener("input",i),idToValue.set(null===e||void 0===e?void 0:e.id,t),valueToId.set(t,null===e||void 0===e?void 0:e.id),function(){idToValue.delete(null===e||void 0===e?void 0:e.id),valueToId.delete(t),null===e||void 0===e||e.removeEventListener("input",i),null===r||void 0===r||r.unsubscribe()}}var index=0,freshIndex=function(){return++index};function runJs(constraints,elements){Array.from(hotdrink__WEBPACK_IMPORTED_MODULE_2__.defaultConstraintSystem.allComponents()).forEach((function(e){return hotdrink__WEBPACK_IMPORTED_MODULE_2__.defaultConstraintSystem.removeComponent(e)}));try{var _iterator=Object(_home_db_skole_hd_visual2_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper__WEBPACK_IMPORTED_MODULE_1__.a)(constraints),_step;try{var _loop=function _loop(){var constraint=_step.value,func=function func(method){return eval("(".concat(constraint.fromIds.join(", "),") => {\n                ").concat(method.code,"\n            }"))},unionIds=Array.from(new Set([].concat(Object(_home_db_skole_hd_visual2_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__.a)(constraint.fromIds),Object(_home_db_skole_hd_visual2_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__.a)(constraint.methods.map((function(e){return e.toIds})).flat())))),methods=constraint.methods.map((function(e){return new hotdrink__WEBPACK_IMPORTED_MODULE_2__.Method(unionIds.length,constraint.fromIds.map((function(e){return unionIds.indexOf(e)})),e.toIds.map((function(e){return unionIds.indexOf(e)})),Object(_home_db_skole_hd_visual2_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__.a)(constraint.fromIds.map((function(){return hotdrink__WEBPACK_IMPORTED_MODULE_2__.maskNone}))),func(e))})),cspec=new hotdrink__WEBPACK_IMPORTED_MODULE_2__.ConstraintSpec(methods),comp=new hotdrink__WEBPACK_IMPORTED_MODULE_2__.Component("Component".concat(freshIndex())),vars=unionIds.map((function(e){var t,n;return comp.emplaceVariable(e,null!==(t=null===(n=elements.getElementById(e))||void 0===n?void 0:n.value)&&void 0!==t?t:"")}));comp.emplaceConstraint("C".concat(freshIndex()),cspec,vars,!1),hotdrink__WEBPACK_IMPORTED_MODULE_2__.defaultConstraintSystem.addComponent(comp),hotdrink__WEBPACK_IMPORTED_MODULE_2__.defaultConstraintSystem.update();try{for(var _i=0,_unionIds=unionIds;_i<_unionIds.length;_i++){var id=_unionIds[_i],bindingType=elements.getElementById(id).binding;DOMBind(document.getElementById(id),comp.vs[id],bindingType)}}catch(e){console.error(e)}};for(_iterator.s();!(_step=_iterator.n()).done;)_loop()}catch(err){_iterator.e(err)}finally{_iterator.f()}console.log(Object(hotdrink__WEBPACK_IMPORTED_MODULE_2__.constraintSystemToJson)(hotdrink__WEBPACK_IMPORTED_MODULE_2__.defaultConstraintSystem))}catch(e){console.error(e)}}function upperCaseFirst(e){return e.slice(0,1).toUpperCase()+e.slice(1)}function lowerCaseFirst(e){return e.slice(0,1).toLowerCase()+e.slice(1)}function clamp(e,t){return e<0?0:e>t?t:e}function socketYAxisPlacement(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return n?1===n?o?e.y+e.height/2:e.height/2:o?e.y+e.height/(2*n)*t:e.height/(2*n)*t:0}},88:function(e,t,n){}},[[126,1,2]]]);
//# sourceMappingURL=main.bdbac7ef.chunk.js.map